package com.obss.jss.cvedownloader.model;

import java.util.List;

import javax.persistence.Column;
import javax.persistence.ElementCollection;
import javax.persistence.Entity;
import javax.persistence.Id;
import com.obss.jss.cvedownloader.DAO.CveDAO;

import lombok.Getter;
import lombok.Setter;

@Entity
@Getter
public class Cve
{
	@Id
	@Setter
	private String id;
	
	@Setter
	private String lastModified;
	
	@Setter
	private String assigner;
	
	@Setter
	private Double cvss;
	
	@Setter
	private String cwe;
	
	@Setter
	private String cvssTime;
	
	@Setter
	private String cvssVector;
	
	@Column
    @ElementCollection(targetClass=String.class)
	@Setter
	private List<String> vulnerable_configuration;
	
	@Column
    @ElementCollection(targetClass=String.class)
	@Setter
	private List<String> vulnerable_configuration_cpe_2_2;
	
	
	// a reference is a Url, length of it may be near to 2000
	@Column(length=2000)
    @ElementCollection(targetClass=String.class)
	@Setter
	private List<String> references;
	
	@Column
    @ElementCollection(targetClass=String.class)
	@Setter
	private List<String> vulnerable_product;
	
	@Column(length=2000)
	private String summary;
	public Cve()
	{
		
	}
	public Cve(CveDAO cveDao)
	{
		this.setId(cveDao.getId());
		this.setLastModified(cveDao.getLastModified());
		this.setVulnerable_product(cveDao.getVulnerable_product());
		this.setSummary(cveDao.getSummary());
		this.setReferences(cveDao.getReferences());
		this.setAssigner(cveDao.getAssigner());
		this.setCvss(cveDao.getCvss());
		this.setCwe(cveDao.getCwe());
		this.setCvssTime(cveDao.getCvssTime());
		this.setCvssVector(cveDao.getCvssVector());
		this.setVulnerable_configuration_cpe_2_2(cveDao.getVulnerable_configuration());
		this.setVulnerable_configuration(cveDao.getVulnerable_configuration());
	}
	
	public void setSummary(String summary)
	{
		if(summary.length() > 2000) summary = summary.substring(0,1997) + "...";
		this.summary = summary;
	}
	

}

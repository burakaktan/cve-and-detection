package com.obss.jss.cvedownloader.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import com.obss.jss.cvedownloader.model.Cve;

@Repository
public interface CveRepository extends JpaRepository<Cve,String>
{	
	@Query("SELECT MAX(c.lastModified) from Cve c")
	String getLastModificationTimeAsString();
	
	@Query("SELECT DISTINCT c FROM Cve c JOIN c.vulnerable_product vulp WHERE vulp LIKE :cpeCode%")
	List<Cve> findCpeRelatedCve(String cpeCode);
}
